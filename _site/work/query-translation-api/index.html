<!DOCTYPE html>
<html class="scroll-smooth" lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Query Translation API - Natural Language to Database Queries</title>
  <meta name="description" content="Architected and launched "ScarletLilyBeetle" - a FastAPI microservice that turns natural-language requests into optimized Dimensions searches via LLM entity extraction and pgvector semantic search.">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Query Translation API - Natural Language to Database Queries">
  <meta property="og:description" content="Architected and launched "ScarletLilyBeetle" - a FastAPI microservice that turns natural-language requests into optimized Dimensions searches via LLM entity extraction and pgvector semantic search.">
  <meta property="og:url" content="https://kjgarza.github.io//work/query-translation-api/">
  <meta property="og:site_name" content="Kristian Garza">
  <meta property="og:locale" content="en_US">
  <meta property="og:image" content="https://kjgarza.github.io//Thumbnail.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="Kristian Garza">
  <meta property="og:type" content="website">
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Query Translation API - Natural Language to Database Queries">
  <meta name="twitter:description" content="Architected and launched "ScarletLilyBeetle" - a FastAPI microservice that turns natural-language requests into optimized Dimensions searches via LLM entity extraction and pgvector semantic search.">
  <meta name="twitter:image" content="https://kjgarza.github.io//Thumbnail.png">
  <meta name="twitter:image:width" content="1200">
  <meta name="twitter:image:height" content="630">
  <meta name="twitter:image:alt" content="Kristian Garza">
  
  <link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16">
  <link rel="stylesheet" href="/_next/static/css/b79f6ce842955dc5.css">
  <script async src="https://tally.so/widgets/embed.js"></script>
</head>
<body class="bg-default scrollbar-hide flex min-h-screen flex-col items-center justify-center font-sans">
  <nav class="align-center top-0 z-1 flex min-h-[88px] w-full max-w-4xl flex-row items-center justify-between gap-4 bg-linear-to-t from-white/0 from-0% to-white to-10% px-4 pt-4 pb-8 text-sm font-medium sm:sticky sm:to-25% md:px-12 xl:px-8">
  <div class="flex min-h-[40px] items-center gap-4">
    
    <!-- Case Study Back Button -->
    <button onclick="history.back()" class="before:block: before:rounded-lg before:absolute before:top-0 before:bottom-0 before:right-0 before:left-0 inline-flex gap-3 relative items-center justify-center whitespace-nowrap rounded-lg text-base font-medium ring-offset-white disabled:pointer-events-none disabled:bg-neutral-100 disabled:text-neutral-500 disabled:shadow-none active:transform active:scale-[99%] active:transition-transform active:duration-75 active:ease-in-out hover:cursor-pointer text-neutral-900 hover:before:bg-special-state-hover h-10 w-10">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left">
        <path d="m12 19-7-7 7-7"></path>
        <path d="M19 12H5"></path>
      </svg>
    </button>
    
    
    <div class="flex flex-col font-mono lg:flex-row lg:gap-2">
      <a class="text-secondary hover:text-primary" href="/">Kristian Garza</a>
      <span class="text-secondary hidden lg:inline">—</span>
      
      <span class="text-primary">/ Case study</span>
      
    </div>
  </div>
  <div class="flex items-center gap-1">
    
    <a class="text-secondary hover:text-primary rounded-lg p-2 transition-colors duration-200 ease-in-out " href="/">
      About
    </a>
    
    <a class="text-secondary hover:text-primary rounded-lg p-2 transition-colors duration-200 ease-in-out " href="/work">
      Work
    </a>
    
    <a class="text-secondary hover:text-primary rounded-lg p-2 transition-colors duration-200 ease-in-out " href="/playground">
      Playground
    </a>
    
    <a class="text-secondary hover:text-primary rounded-lg p-2 transition-colors duration-200 ease-in-out " href="/tools">
      Tools
    </a>
    
  </div>
</nav>

  
  <main class="mx-auto flex h-full w-full max-w-4xl grow flex-col justify-center gap-16 p-4 font-sans md:p-12 xl:p-8">
    
<div class="flex w-full max-w-2xl flex-1 flex-col items-center gap-8 sm:p-4">
  <!-- Case Study Header -->
  <div class="bg-surface flex flex-col gap-2 p-4 sm:rounded-lg sm:p-6">
    <!-- Company and Tags -->
    <div class="flex flex-row items-center justify-between">
      <p class="font-mono">Digital Science</p>
      <div class="flex flex-row gap-1">
        
        <div class="inline-flex items-center rounded-full border-2 px-2 py-1 w-fit h-fit text-xs font-bold transition-colors border-neutral-300 bg-white text-primary">
          API Development
        </div>
        
        <div class="inline-flex items-center rounded-full border-2 px-2 py-1 w-fit h-fit text-xs font-bold transition-colors border-neutral-300 bg-white text-primary">
          Machine Learning
        </div>
        
        <div class="inline-flex items-center rounded-full border-2 px-2 py-1 w-fit h-fit text-xs font-bold transition-colors border-neutral-300 bg-white text-primary">
          Backend Engineering
        </div>
        
      </div>
    </div>
    
    <!-- Title and Description -->
    <div class="flex w-full flex-col gap-1">
      <h1 class="text-primary text-2xl font-bold">Query Translation API - Natural Language to Database Queries</h1>
      <p class="text-secondary text-base font-medium">Architected and launched "ScarletLilyBeetle" - a FastAPI microservice that turns natural-language requests into optimized Dimensions searches via LLM entity extraction and pgvector semantic search.</p>
    </div>
    
    <!-- Hero Image -->
    
    <img alt="Query Translation API - Natural Language to Database Queries" width="640" height="400" decoding="async" data-nimg="1" 
         class="mt-4 h-auto w-full rounded-sm" src="https://i.imgur.com/placeholder-api.png" loading="lazy">
    
  </div>
  
  <!-- Case Study Content -->
  <div class="prose prose-h1:text-2xl prose-h2:text-xl prose-h2:mb-2 prose-h3:mb-3 prose-p:mt-0 prose-p:mb-3 prose-h3:text-lg prose-a:text-accent prose-a:underline prose-ul:mt-0 prose-ul:mb-3 prose-li:mt-0 prose-li:mb-3 prose-p:text-base prose-img:my-3 px-4 font-medium sm:px-6">
    <h2>Overview</h2>
<p>The Query Translation API (codenamed &quot;ScarletLilyBeetle&quot;) is an innovative solution designed to bridge the gap between natural language user queries and structured database queries for the Dimensions database system. This service allows users to interact with complex research data using natural language, significantly improving accessibility and usability of research information systems.</p>
<p>Researchers and data analysts often struggle with formulating complex database queries to find relevant publications, grants, clinical trials, and patents in the Dimensions database. The traditional approach requires knowledge of specific query syntax and familiarity with the underlying data schema, creating a high barrier to entry for many users.</p>
<h2>Problem Statement</h2>
<p>Researchers and data analysts often struggle with formulating complex database queries to find relevant publications, grants, clinical trials, and patents in the Dimensions database. The traditional approach requires knowledge of specific query syntax and familiarity with the underlying data schema, creating a high barrier to entry for many users. This results in:</p>
<ul>
<li>Inefficient data retrieval</li>
<li>Missed research opportunities</li>
<li>Frustration when exploring scientific literature</li>
<li>High learning curve for new users</li>
</ul>
<h2>Solution Overview</h2>
<p>The Query Translation API addresses these challenges by implementing a sophisticated natural language processing pipeline that:</p>
<ol>
<li><strong>Accepts natural language queries</strong> from users</li>
<li><strong>Extracts key entities and intents</strong> using a Large Language Model</li>
<li><strong>Resolves entities</strong> against an embedding store for semantic matching</li>
<li><strong>Translates the extracted information</strong> into structured Dimensions queries</li>
<li><strong>Returns both the formatted query URL</strong> and relevant search results</li>
</ol>
<p>The system transforms casual user questions like <em>&quot;Find chemistry papers published in Nature after 2020&quot;</em> into precise database queries that can be executed against the Dimensions database.</p>
<h2>Technical Architecture</h2>
<h3>Technology Stack</h3>
<ul>
<li><strong>Backend Framework</strong>: FastAPI</li>
<li><strong>Language Model Integration</strong>: LangChain with OpenAI</li>
<li><strong>Vector Database</strong>: PostgreSQL with pgvector</li>
<li><strong>Search Engine</strong>: Solr</li>
<li><strong>Containerization</strong>: Docker, Kubernetes (via Skaffold)</li>
<li><strong>CI/CD</strong>: GitLab CI</li>
<li><strong>Monitoring</strong>: Sentry, Prometheus</li>
<li><strong>Testing</strong>: Pytest with VCR for API mocking</li>
</ul>
<h3>Key Components</h3>
<h4>Entity Extraction Service</h4>
<p>The GPTExtractorService leverages large language models to parse natural language queries and extract structured entities according to predefined schemas. This service forms the initial processing layer that identifies what the user is looking for.</p>
<h4>Schema Definitions</h4>
<p>The system defines a comprehensive set of dimension resources that represent the different facets of research data, including:</p>
<ul>
<li>Researchers and author information</li>
<li>Publication sources and journals</li>
<li>Year ranges and temporal filtering</li>
<li>Open access status and availability</li>
<li>Citation metrics and impact scores</li>
<li>Altmetric scores and social engagement</li>
<li>Research organizations and affiliations</li>
<li>Funding information and grants</li>
</ul>
<p>Each dimension implements specialized query methods that transform natural language entities into structured query parameters.</p>
<h3>Architecture Flow</h3>
<p>The system follows a microservice architecture pattern:</p>
<ol>
<li><strong>User Interface</strong>: Accepts natural language queries</li>
<li><strong>Translator Service</strong>: Orchestrates the translation pipeline</li>
<li><strong>LLM Integration</strong>: Performs entity extraction and query generation</li>
<li><strong>Embedding Store</strong>: Provides semantic search capabilities for entity resolution</li>
<li><strong>Dimensions DB Interface</strong>: Executes the generated queries against the database</li>
</ol>
<h2>Challenges and Solutions</h2>
<h3>Entity Resolution Accuracy</h3>
<p><strong>Challenge</strong>: Accurately mapping vague or ambiguous terms in user queries to specific entities in the database.</p>
<p><strong>Solution</strong>: Implemented semantic search using vector embeddings stored in PostgreSQL, allowing fuzzy matching of concepts rather than requiring exact terminology. This approach significantly improved entity resolution for researcher names, journal titles, and subject areas.</p>
<h3>Query Optimization</h3>
<p><strong>Challenge</strong>: Translating complex natural language into efficient database queries.</p>
<p><strong>Solution</strong>: Developed specialized query generation patterns for each dimension type, ensuring the produced queries follow optimization best practices. The system also implements caching via Redis to improve performance for common query patterns.</p>
<h3>Deployment and Scaling</h3>
<p><strong>Challenge</strong>: Ensuring consistent performance under varying load conditions.</p>
<p><strong>Solution</strong>: Containerized the application using Docker and implemented Kubernetes deployment via Skaffold, with environment-specific configurations for development and production environments. This approach allows for horizontal scaling and simplified deployment across different infrastructure environments.</p>
<h2>Impact and Results</h2>
<p>The Query Translation API delivers several significant benefits:</p>
<h3>Democratized Access</h3>
<p>Researchers without database query expertise can now effectively search complex research datasets using natural language.</p>
<h3>Time Efficiency</h3>
<p>Users can find relevant research papers, grants, and patents significantly faster than with traditional query methods.</p>
<h3>Improved Discovery</h3>
<p>The semantic matching capabilities help users discover relevant research they might have missed with keyword-only searches.</p>
<h3>Cross-Domain Integration</h3>
<p>The system supports queries across multiple Dimensions data types (publications, grants, clinical trials, patents), enabling more comprehensive research exploration.</p>
<h2>Key Achievements</h2>
<ul>
<li><strong>Architected end-to-end system</strong> from concept to production deployment</li>
<li><strong>Designed sophisticated NLP pipelines</strong> for entity extraction and query translation</li>
<li><strong>Integrated vector search capabilities</strong> using PostgreSQL with pgvector</li>
<li><strong>Orchestrated comprehensive CI/CD</strong> with GitLab CI for automated testing and deployment</li>
<li><strong>Ensured production scalability</strong> with Docker-Kubernetes infrastructure</li>
<li><strong>Implemented comprehensive monitoring</strong> with Sentry and Prometheus</li>
</ul>
<h2>Conclusion</h2>
<p>The ScarletLilyBeetle project represents a successful application of modern NLP and vector search technologies to solve a practical problem in research data access. By creating an intuitive bridge between natural language and structured database queries, it significantly lowers the barrier to engaging with complex research datasets.</p>
<p>The project demonstrates effective integration of LLMs with traditional database systems, showcasing a hybrid approach that leverages the strengths of both technologies. The architecture provides a blueprint for similar translation services in other domains where technical query languages create accessibility challenges.</p>
<p>Future enhancements could include expanding the supported entity types, improving multi-intent query handling, and developing more sophisticated disambiguation strategies for complex research concepts.</p>

  </div>

  
  <div class="to-white-16 -mt-24 flex w-full items-center justify-center bg-linear-to-t from-white from-80% to-100% pt-20">
    <div class="border-card rounded-lg border bg-white text-neutral-900 mx-4 max-w-[400px] shadow-sm">
      <div class="flex flex-col p-6">
        <h3 class="text-primary text-xl font-bold">This content requires a password</h3>
        <p class="text-secondary text-base font-medium">Some things are meant to stay private. But if you're meant to see this, just reach out to me.</p>
      </div>
      <div class="p-6 pt-0">
        <form class="flex flex-col">
          <label class="text-sm font-medium text-primary leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 mb-2" for="Password">Password</label>
          <input type="password" class="flex h-10 rounded-md border-2 border-neutral-300 bg-white px-3 py-2 font-sans text-base font-medium file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-neutral-500 focus:border-neutral-900 disabled:cursor-not-allowed disabled:opacity-50 w-full" id="Password" value="">
          <button class="before:block: before:rounded-lg before:absolute before:top-0 before:bottom-0 before:right-0 before:left-0 inline-flex gap-3 relative items-center justify-center whitespace-nowrap rounded-lg text-base font-medium ring-offset-white disabled:pointer-events-none disabled:bg-neutral-100 disabled:text-neutral-500 disabled:shadow-none active:transform active:scale-[99%] active:transition-transform active:duration-75 active:ease-in-out hover:cursor-pointer hover:before:bg-special-state-hover-inverse bg-button-primary text-white shadow-button-primary-rest active:shadow-none h-10 px-3 min-w-9 mt-6 w-full" type="submit">Submit</button>
        </form>
      </div>
    </div>
  </div>
  
</div>

  </main>
  
  <footer class="text-primary flex w-full max-w-4xl flex-col items-center justify-between gap-1 px-4 pt-8 pb-24 font-mono font-medium sm:pb-8 md:px-12 xl:px-8">
  <div class="flex flex-wrap items-center gap-4">
    <div class="flex items-center gap-4">
      <a class="hover:text-accent hover:underline" target="_blank" href="https://kjgarza.substack.com/">
        Figma
      </a>
    </div>
    <div class="flex items-center gap-4">
      <span class="text-neutral-400">·</span>
      <a class="hover:text-accent hover:underline" target="_blank" href="https://github.com/kristiangarza">
        Github
      </a>
    </div>
    <div class="flex items-center gap-4">
      <span class="text-neutral-400">·</span>
      <a class="hover:text-accent hover:underline" target="_blank" href="https://www.linkedin.com/in/kjgarza">
        LinkedIn
      </a>
    </div>
    <div class="flex items-center gap-4">
      <span class="text-neutral-400">·</span>
      <a class="hover:text-accent hover:underline" target="_blank" href="mailto:kj.garza@gmail.com">
        Email
      </a>
    </div>
  </div>
  <p class="text-secondary text-sm">Copyright © 2025 Kristian Garza</p>
</footer>

</body>
</html>
